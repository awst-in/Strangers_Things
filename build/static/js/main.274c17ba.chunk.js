(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{69:function(e,t,n){"use strict";n.r(t);var r=n(8),s=n.n(r),c=n(10),a=n(5),o=n(0),i=n(21),j=n.n(i),l=n(9),u=n(11),d=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,r,c,a,o,i,j;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.method,c=t.token,a=t.body,e.prev=1,o={method:r?r.toUpperCase():"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)},c&&(o.headers.Authorization="Bearer ".concat(c)),e.next=6,fetch("https://strangers-things.herokuapp.com/api/2108-LSU-RM-WEB-PT"+n,o);case 6:return i=e.sent,e.next=9,i.json();case 9:if(!(j=e.sent).error){e.next=12;break}throw j.error;case 12:return e.abrupt("return",j);case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR: ",e.t0);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),b=n(71),p=n(72),h=n(1),O=function(e){var t=e.action,n=e.setToken,r=Object(o.useState)(""),i=Object(a.a)(r,2),j=i[0],O=i[1],x=Object(o.useState)(""),f=Object(a.a)(x,2),v=f[0],g=f[1],m="login"===t,k=m?"Login":"Register",y=m?"New user?":"Already have an account?",w=m?"register":"login",D=Object(l.f)(),S=function(){var e=Object(c.a)(s.a.mark((function e(r){var c,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,d({url:"/users/".concat(t),body:{user:{username:j,password:v}},method:"POST"});case 3:a=e.sent,(o=null===a||void 0===a||null===(c=a.data)||void 0===c?void 0:c.token)&&(localStorage.setItem("token",o),O(""),g(""),n(o),D.push("/"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(b.a,{style:{padding:"1px"},children:[Object(h.jsx)("h2",{children:k}),Object(h.jsxs)("form",{onSubmit:S,children:[Object(h.jsx)("input",{type:"text",placeholder:"username",value:j,required:!0,onChange:function(e){return O(e.target.value)}}),Object(h.jsx)("input",{type:"password",placeholder:"password",value:v,onChange:function(e){return g(e.target.value)}})," ",Object(h.jsx)("br",{}),Object(h.jsx)(p.a,{variant:"secondary",type:"submit",children:k})]}),Object(h.jsx)(u.b,{to:"/".concat(w),children:y})]})})},x=n(76),f={searchContainer:{display:"flex",justifyContent:"center",padding:0,alignItems:"center"},searchInput:{margin:"0 16px"}},v=function(e){var t=e.posts,n=Object(l.f)(),r=(Object(l.g)().postId,Object(o.useState)("")),s=Object(a.a)(r,2),c=s[0],i=s[1],j=t.filter((function(e){return function(e,t){for(var n=t.toLowerCase(),r=0,s=[e.description,e.location,e.title,e.author.username];r<s.length;r++)if(s[r].toLowerCase().includes(n))return!0}(e,c)}));return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{style:f.searchContainer,children:[Object(h.jsx)("h2",{children:"Posts"}),Object(h.jsx)("input",{style:f.searchInput,type:"text",placeholder:"search for posts",value:c,onChange:function(e){i(e.target.value)}})]}),j.length?j.map((function(e){return Object(h.jsx)(x.a,{style:{width:"auto"},children:Object(h.jsxs)("div",{style:{width:"auto",padding:"10px"},children:[Object(h.jsx)("h5",{children:e.title}),Object(h.jsxs)("div",{children:["Posted by: ",e.author.username]}),Object(h.jsxs)("div",{children:["Description: ",e.description]}),Object(h.jsxs)("div",{children:["Location: ",e.location]}),Object(h.jsx)(p.a,{variant:"secondary",onClick:function(){return n.push("/posts/".concat(e._id))},children:"View Post"})]},e._id)})})):Object(h.jsx)("div",{children:"No posts to display"})]})},g=function(e){var t=e.posts,n=e.token,r=e.setPosts,s=e.userData,c=Object(l.g)().postId,a=Object(l.f)(),o=t.find((function(e){return c===e._id})),i=s.username===o.author.username;return Object(h.jsx)(h.Fragment,{children:o?Object(h.jsx)("div",{children:Object(h.jsxs)(b.a,{children:[Object(h.jsx)("h3",{children:o.title}),Object(h.jsxs)("p",{children:["Posted by: ",o.author.username]}),Object(h.jsxs)("p",{children:["Price: ",o.price]}),Object(h.jsxs)("p",{children:["Location: ",o.location]}),Object(h.jsxs)("p",{children:["Delivers: ",o.willDeliver?"Yes":"No"]}),i?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(p.a,{variant:"secondary",onClick:function(){return a.push("".concat(c,"/edit"))},children:"Edit"})," ",Object(h.jsx)(I,{token:n,postId:c,setPosts:r})]}):"",n?Object(h.jsx)(h.Fragment,{children:i?"":Object(h.jsx)(T,{token:n,postId:c})}):""]})}):""})},m=n(74),k=n(75),y={display:"flex",margin:"auto",textDecoration:"none",color:"black",alignItems:"flex-end"},w=function(e){var t=e.token,n=Object(l.f)(),r=function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.removeItem("token"),n.push("/"),window.location.reload(!1);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(m.a,{bg:"secondary",variant:"secondary",sticky:"top",children:[Object(h.jsx)(m.a.Brand,{children:"Stranger's Things"}),Object(h.jsxs)(k.a,{className:"me-auto",children:[Object(h.jsx)(k.a.Link,{to:"/",children:Object(h.jsx)(u.b,{to:"/",style:y,children:"Home "})}),Object(h.jsx)("br",{}),t?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(k.a.Link,{children:Object(h.jsx)(u.b,{to:"/profile",style:y,children:"Profile"})}),Object(h.jsx)("br",{}),Object(h.jsx)(k.a.Link,{children:Object(h.jsx)(u.b,{to:"/posts/new",style:y,children:"Add Post"})}),Object(h.jsx)("br",{}),Object(h.jsx)(k.a.Link,{children:Object(h.jsx)(u.b,{to:"/",style:y,onClick:r,children:"Logout"})})]}):Object(h.jsx)(k.a.Link,{children:Object(h.jsx)(u.b,{to:"/login",style:y,children:"Login"})})]})]})})},D=n(7),S=n(2),C=n(34),P=function(e){var t=e.token,n=e.setPosts,r=e.posts,i=e.action,j=Object(l.g)().postId,u=Object(l.f)(),O=Object(o.useState)({title:"",description:"",price:0,location:"",willDeliver:!1}),x=Object(a.a)(O,2),f=x[0],v=x[1],g="edit"===i,m=g?"Edit this post":"Add a new post",k=g?"PATCH":"POST",y=g?"/posts/".concat(j):"/posts",w=function(){var e=Object(c.a)(s.a.mark((function e(c){var a,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),e.prev=1,e.next=4,d({url:y,method:k,body:{post:{title:f.title,description:f.description,price:f.price,location:f.location,willDeliver:f.willDeliver}},token:t});case 4:a=e.sent,o=a.data.post,g?(i=r.filter((function(e){return e._id!==j})),n([].concat(Object(C.a)(i),[o]))):n([].concat(Object(C.a)(r),[o])),u.push("/posts"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.error("error adding a post: ",e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),P=function(e){return function(t){v("willDeliver"===e?Object(S.a)(Object(S.a)({},f),{},Object(D.a)({},e,t.target.checked)):Object(S.a)(Object(S.a)({},f),{},Object(D.a)({},e,t.target.value)))}};return Object(h.jsx)(b.a,{children:Object(h.jsxs)("div",{children:[Object(h.jsx)("h2",{children:m}),Object(h.jsxs)("form",{onSubmit:w,children:[Object(h.jsx)("input",{type:"text",placeholder:"Title Of Post",value:f.title,onChange:P("title")}),Object(h.jsx)("br",{}),Object(h.jsx)("textarea",{type:"text",rows:"6",placeholder:"Description",value:f.description,onChange:P("description")}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"number",placeholder:"Price of Item",value:f.price,onChange:P("price")}),Object(h.jsx)("br",{}),Object(h.jsx)("input",{type:"text",placeholder:"Location",value:f.location,onChange:P("location")}),Object(h.jsx)("br",{}),Object(h.jsx)("label",{children:"Deliver?"}),Object(h.jsx)("input",{type:"checkbox",value:f.willDeliver,onChange:P("willDeliver")}),Object(h.jsx)("br",{}),t?Object(h.jsx)(p.a,{variant:"secondary",type:"submit",children:m}):""]})]})})},I=function(e){var t=e.token,n=Object(l.f)(),r=Object(l.g)().postId,a="/posts/".concat(r),o=function(){var e=Object(c.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d({url:a,method:"DELETE",token:t});case 3:n.push("/"),window.location.reload(!1),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error deleting a post:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(p.a,{variant:"secondary",onClick:o,children:"Delete Post"})})},L=n(73),T=function(e){var t=e.token,n=Object(o.useState)(""),r=Object(a.a)(n,2),i=r[0],j=r[1],u=Object(l.g)().postId,b=Object(l.f)(),O="/posts/".concat(u,"/messages"),x=function(){var e=Object(c.a)(s.a.mark((function e(n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,d({url:O,method:"POST",body:{message:{content:"".concat(i)}},token:t});case 4:b.push("/"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("error adding a message:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:t?Object(h.jsxs)("form",{onSubmit:x,children:[Object(h.jsx)(L.a,{sm:"2",children:Object(h.jsx)("textarea",{type:"text",rows:"3",placeholder:"Message",value:i,onChange:function(e){return j(e.target.value)}})}),Object(h.jsx)("br",{}),Object(h.jsx)(p.a,{variant:"secondary",children:"Send"})]}):""})},F=n(52),E=function(e){var t=e.token,n=e.userData,r=Object(o.useState)([]),i=Object(a.a)(r,2),j=i[0],l=i[1],u=Object(o.useState)(!1),O=Object(a.a)(u,2),f=O[0],v=O[1],g=function(){var e=Object(c.a)(s.a.mark((function e(n){var r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),v(!f),e.prev=2,e.next=5,d({url:"/users/me",token:t});case 5:r=e.sent,c=r.data.messages,console.log("data:",r),l(c),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:Object(h.jsx)(b.a,{children:Object(h.jsxs)("div",{children:[Object(h.jsxs)("h2",{children:["Hello ",n.username,"!"]}),Object(h.jsx)(p.a,{variant:"secondary",onClick:g,"aria-controls":"example-collapse-text","aria-expanded":f,children:"Get Messages"}),j.map((function(e){return Object(h.jsx)(F.a,{in:f,dimension:"width",children:Object(h.jsx)(x.a,{body:!0,style:{width:"90%"},className:"mb-2",children:Object(h.jsxs)("div",{style:{minHeight:"150px"},children:[Object(h.jsxs)("h3",{children:["From: ",e.fromUser.username]}),Object(h.jsxs)("h4",{children:["Post: ",e.post.title]}),Object(h.jsxs)("p",{children:['"',e.content,'"']})]},e._id)})})}))]})})})},_=(n(68),function(){var e=Object(o.useState)(""),t=Object(a.a)(e,2),n=t[0],r=t[1],i=Object(o.useState)({}),j=Object(a.a)(i,2),u=j[0],b=j[1],p=Object(o.useState)([]),x=Object(a.a)(p,2),f=x[0],m=x[1],k=Object(o.useState)([]),y=Object(a.a)(k,2),D=y[0],S=y[1],C=function(){var e=Object(c.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/users/me",token:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(c.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({url:"/posts"});case 2:return t=e.sent,n=t.data.posts,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(o.useEffect)(Object(c.a)(s.a.mark((function e(){var t,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:if(t=e.sent,m(t),n){e.next=7;break}return r(localStorage.getItem("token")),e.abrupt("return");case 7:return e.next=9,C(n);case 9:(c=e.sent)&&c.username&&b(c);case 11:case"end":return e.stop()}}),e)}))),[n]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(w,{token:n,setToken:r,userData:u,setUserData:b}),Object(h.jsxs)(l.c,{children:[Object(h.jsx)(l.a,{exact:!0,path:"/",children:Object(h.jsx)(v,{posts:f,token:n})}),Object(h.jsx)(l.a,{exact:!0,path:"/profile",children:Object(h.jsx)(E,{messages:D,token:n,userData:u})}),Object(h.jsx)(l.a,{exact:!0,path:"/posts",children:Object(h.jsx)(v,{posts:f,token:n})}),Object(h.jsx)(l.a,{path:"/posts/new",children:n?Object(h.jsx)(P,{token:n,setPosts:m,posts:f,action:"add"}):"You must be logged in to add a post!"}),Object(h.jsx)(l.a,{path:"/posts/:postId/edit",children:n?Object(h.jsx)(P,{token:n,setPosts:m,posts:f,action:"edit"}):""}),Object(h.jsx)(l.a,{path:"/posts/:postId",children:Object(h.jsx)(g,{posts:f,token:n,userData:u})}),Object(h.jsx)(l.a,{path:"/posts/:postId/messages",children:n?Object(h.jsx)(T,{posts:f,token:n,messages:D,setMessages:S}):""}),Object(h.jsx)(l.a,{path:"/register",children:Object(h.jsx)(O,{action:"register",setToken:r,setUserData:b})}),Object(h.jsx)(l.a,{path:"/login",children:n?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("div",{children:"You are already logged in!"}),Object(h.jsx)("br",{})]}):Object(h.jsx)(O,{action:"login",setToken:r,setUserData:b})})]})]})});j.a.render(Object(h.jsx)(u.a,{children:Object(h.jsx)(_,{})}),document.getElementById("app"))}},[[69,1,2]]]);
//# sourceMappingURL=main.274c17ba.chunk.js.map